var we=Object.defineProperty;var ke=(f,s,o)=>s in f?we(f,s,{enumerable:!0,configurable:!0,writable:!0,value:o}):f[s]=o;var L=(f,s,o)=>(ke(f,typeof s!="symbol"?s+"":s,o),o);import{a as Ce,_ as Le}from"./Tab.vue_vue_type_script_setup_true_lang.ebb0cf62.js";import{f as Y,E as F,h as b,W as De,b6 as Ee,g as U,p as P,dW as Ne,ae as Me,dX as Re,z as ie,o as i,d as h,e as t,t as n,j as e,N as Ie,i as T,a as c,aB as Ae,ba as Ue,I as Te,x as ee,a5 as H,_ as re,ds as O,dY as ce,dZ as je,aZ as q,d_ as oe,d$ as Be,e0 as Ve,U as ae,V as I,cB as G,e1 as ze,e2 as Oe,m as j,F as de,l as ue,c as A,w as E,Y as M,a2 as _e,e3 as he,e4 as te,bg as qe,e5 as me,e6 as Pe,e7 as Ge,X as Ye,v as K,aa as Fe,e8 as He,e9 as Ze,aG as pe,dF as We,G as J,a$ as Qe,ea as Je,b9 as ne,Z as X,eb as Xe,ec as Ke,C as et,ed as tt,ee as st,ef as ot,eg as nt,eh as lt}from"./index.cb7d2b1b.js";import{B as it,_ as rt}from"./helpers.65ea97b2.js";import{s as ct,I as at}from"./date.5007ec6f.js";import{d as dt}from"./Shortcode.33f3099c.js";import{_ as ut}from"./Toggle.8e68dec1.js";const _t={class:"block w-full my-6 border divide-y lg:flex lg:my-0 lg:border-0 lg:divide-y-0 lg:divide-x divide-dividerLight border-dividerLight"},ht={class:"font-mono text-tiny table-box"},mt={class:"table-box"},pt={class:"justify-center table-box"},ft=Y({__name:"Shortcode",props:{shortcode:null},emits:["delete-shortcode"],setup(f,{emit:s}){const o=f,l=F(),a=H(),_=g=>{s("delete-shortcode",g)},S={get:"text-green-500",post:"text-yellow-500",put:"text-blue-500",delete:"text-red-500",default:"text-gray-500"},m=b(),u=De(Ee,1e3),y=U(()=>P(o.shortcode.request,JSON.parse,Ne)),w=U(()=>P(S,Re(y.value.method.toLowerCase()),Me(()=>S.default))),k=U(()=>ct(o.shortcode.createdOn)),d="https://hopp.sh",p=g=>{Ue(`${d}/r/${g}`),a.success(`${l("state.copied_to_clipboard")}`),u.value=Te};return(g,x)=>{const C=ee,$=ie("tippy");return i(),h("div",_t,[t("div",ht,n(f.shortcode.id),1),t("div",{class:Ie(["table-box",e(w)])},n(e(y).method),3),t("div",mt,n(e(y).endpoint),1),t("div",{ref_key:"timeStampRef",ref:m,class:"table-box"},n(e(k)),513),t("div",pt,[T(c(C,{title:e(l)("action.open_workspace"),to:`${e(d)}/r/${f.shortcode.id}`,blank:"",icon:e(at),class:"px-3 text-accent hover:text-accent"},null,8,["title","to","icon"]),[[$,{theme:"tooltip"}]]),T(c(C,{title:e(l)("action.copy"),color:"green",icon:e(u),class:"px-3",onClick:x[0]||(x[0]=r=>p(f.shortcode.id))},null,8,["title","icon"]),[[$,{theme:"tooltip"}]]),T(c(C,{title:e(l)("action.delete"),icon:e(Ae),color:"red",class:"px-3",onClick:x[1]||(x[1]=r=>_(f.shortcode.id))},null,8,["title","icon"]),[[$,{theme:"tooltip"}]])])])}}});const vt=re(ft,[["__scopeId","data-v-b60546f1"]]);class yt{constructor(s=!1){L(this,"error$");L(this,"loading$");L(this,"shortcodes$");L(this,"hasMoreShortcodes$");L(this,"isDispose");L(this,"myShortcodesCreated");L(this,"myShortcodesRevoked");L(this,"myShortcodesCreatedSub");L(this,"myShortcodesRevokedSub");this.error$=new O(null),this.loading$=new O(!1),this.shortcodes$=new O([]),this.hasMoreShortcodes$=new O(!0),this.isDispose=!0,this.myShortcodesCreated=null,this.myShortcodesRevoked=null,this.myShortcodesCreatedSub=null,this.myShortcodesRevokedSub=null,s||this.initialize()}unsubscribeSubscriptions(){var s,o,l,a;(s=this.myShortcodesCreated)==null||s.unsubscribe(),(o=this.myShortcodesRevoked)==null||o.unsubscribe(),(l=this.myShortcodesCreatedSub)==null||l.unsubscribe(),(a=this.myShortcodesRevokedSub)==null||a.unsubscribe()}initialize(){if(!this.isDispose)throw new Error("Adapter is already initialized");this.fetchList(),this.registerSubscriptions()}isInitialized(){return!this.isDispose}dispose(){if(this.isDispose)throw new Error("Adapter has been disposed");this.isDispose=!0,this.unsubscribeSubscriptions()}fetchList(){this.loadMore(!0)}async loadMore(s=!1){if(!this.hasMoreShortcodes$.value&&!s)return;this.loading$.next(!0);const o=this.shortcodes$.value.length>0?this.shortcodes$.value[this.shortcodes$.value.length-1].id:void 0,l=await ce({query:je,variables:{cursor:o}});if(q(l))throw this.error$.next(l.left),console.error(l.left),this.loading$.next(!1),new Error(`Failed fetching short codes list: ${l.left}`);const a=l.right.myShortcodes;this.pushNewShortcodes(a),a.length!==it&&this.hasMoreShortcodes$.next(!1),this.loading$.next(!1)}pushNewShortcodes(s){const o=this.shortcodes$.value;o.push(...s),this.shortcodes$.next(o)}createShortcode(s){const o=this.shortcodes$.value;o.unshift(s),this.shortcodes$.next(o)}deleteShortcode(s){const o=this.shortcodes$.value.filter(({id:l})=>l!==s);this.shortcodes$.next(o)}registerSubscriptions(){const[s,o]=oe({query:Be});this.myShortcodesCreatedSub=o,this.myShortcodesCreated=s.subscribe(_=>{if(q(_))throw console.error(_.left),new Error(`Shortcode Create Error ${_.left}`);this.createShortcode(_.right.myShortcodesCreated)});const[l,a]=oe({query:Ve});this.myShortcodesRevokedSub=a,this.myShortcodesRevoked=l.subscribe(_=>{if(q(_))throw console.error(_.left),new Error(`Shortcode Delete Error ${_.left}`);this.deleteShortcode(_.right.myShortcodesRevoked.id)})}}const gt={class:"p-4"},bt={class:"font-semibold text-secondaryDark"},xt={class:"my-1 text-secondaryLight"},$t={class:"relative py-4 overflow-x-auto"},St={key:0,class:"flex flex-col items-center justify-center"},wt={class:"text-secondaryLight"},kt={key:1,class:"flex flex-col items-center justify-center p-4 text-secondaryLight"},Ct=["src","alt"],Lt={class:"mb-4 text-center"},Dt={key:2},Et={class:"hidden w-full border-t rounded-t bg-primaryLight lg:flex border-x border-dividerLight"},Nt={class:"flex w-full overflow-y-scroll"},Mt={class:"table-box"},Rt={class:"table-box"},It={class:"table-box"},At={class:"table-box"},Ut={class:"justify-center table-box"},Tt={class:"flex flex-col items-center justify-between w-full overflow-y-scroll border rounded max-h-sm lg:rounded-t-none lg:divide-y border-dividerLight divide-dividerLight"},jt={key:0,class:"flex flex-col items-center py-3"},Bt={key:3,class:"flex flex-col items-center py-4"},Vt=Y({__name:"Shortcodes",setup(f){var C,$;const s=F(),o=H(),l=_e();ae({title:U(()=>s("navigation.profile"))});const a=I(he,null),_=b((C=a.value)==null?void 0:C.displayName);G(()=>{var r;return _.value=(r=a.value)==null?void 0:r.displayName});const S=b(($=a.value)==null?void 0:$.email);G(()=>{var r;return S.value=(r=a.value)==null?void 0:r.email});const m=new yt(!0),u=I(m.loading$,!1),y=I(m.error$,null),w=I(m.shortcodes$,[]),k=I(m.hasMoreShortcodes$,!0),d=U(()=>u.value&&w.value.length===0);ze(()=>{m.initialize()}),Oe(r=>{if(r.event==="logout"&&m.isInitialized()){m.dispose();return}});const p=r=>{P(dt(r),me(R=>{o.error(`${x(R)}`)},()=>{o.success(`${s("shortcodes.deleted")}`)}))()},g=()=>{m.loadMore()},x=r=>{if(r.type==="network_error")return s("error.network_error");switch(r.error){case"shortcode/not_found":return s("shortcodes.not_found");default:return s("error.something_went_wrong")}};return(r,R)=>{const B=te,N=vt,v=rt,Z=qe;return i(),h("section",gt,[t("h4",bt,n(e(s)("settings.short_codes")),1),t("div",xt,n(e(s)("settings.short_codes_description")),1),t("div",$t,[e(d)?(i(),h("div",St,[c(B,{class:"mb-4"}),t("span",wt,n(e(s)("state.loading")),1)])):j("",!0),!e(d)&&e(w).length===0?(i(),h("div",kt,[t("img",{src:`/images/states/${e(l).value}/add_files.svg`,loading:"lazy",class:"inline-flex flex-col object-contain object-center w-16 h-16 mb-8",alt:`${e(s)("empty.shortcodes")}`},null,8,Ct),t("span",Lt,n(e(s)("empty.shortcodes")),1)])):e(d)?j("",!0):(i(),h("div",Dt,[t("div",Et,[t("div",Nt,[t("div",Mt,n(e(s)("shortcodes.short_code")),1),t("div",Rt,n(e(s)("shortcodes.method")),1),t("div",It,n(e(s)("shortcodes.url")),1),t("div",At,n(e(s)("shortcodes.created_on")),1),t("div",Ut,n(e(s)("shortcodes.actions")),1)])]),t("div",Tt,[(i(!0),h(de,null,ue(e(w),(V,z)=>(i(),A(N,{key:`shortcode-${z}`,shortcode:V,onDeleteShortcode:p},null,8,["shortcode"]))),128)),e(k)&&e(w).length>0?(i(),A(v,{key:0,onIntersecting:R[0]||(R[0]=V=>g())},{default:E(()=>[e(u)?(i(),h("div",jt,[c(B)])):j("",!0)]),_:1})):j("",!0)])])),!e(d)&&e(y)?(i(),h("div",Bt,[c(Z,{class:"mb-4 svg-icons"}),M(" "+n(x(e(y))),1)])):j("",!0)])])}}});const zt=re(Vt,[["__scopeId","data-v-856ec8e4"]]),Ot=()=>Pe(Ge,{}),qt={class:"p-4"},Pt={class:"font-semibold text-secondaryDark"},Gt={class:"my-1 mb-4 text-secondaryLight"},Yt={key:0,class:"flex flex-col items-center justify-center"},Ft={class:"text-secondaryLight"},Ht={key:1,class:"flex flex-col p-4 space-y-2 border border-red-500 rounded-lg text-secondaryDark bg-error"},Zt={class:"font-bold text-red-500"},Wt={class:"my-4 ml-8 space-y-2 list-disc"},Qt={class:"font-semibold"},Jt={key:2},Xt={class:"flex flex-col p-4 mb-4 space-y-2 border border-red-500 rounded-lg text-secondaryDark bg-error"},Kt={class:"font-bold text-red-500"},es={class:"font-medium text-secondaryDark"},ts={class:"flex flex-col"},ss=t("label",{for:"deleteUserAccount"},[M(" Type "),t("span",{class:"font-bold"}," delete my account "),M(" to confirm ")],-1),os={class:"flex space-x-2"},ns=Y({__name:"UserDelete",setup(f){const s=F(),o=H(),l=Fe(),a=b(!1),_=b(""),S=b(!0),m=b([]);Ye(a,d=>{d&&u()});const u=async()=>{S.value=!0;const d=await ce({query:He});if(S.value=!1,q(d))throw new Error(`Failed fetching teams list: ${JSON.stringify(d.left)}`);m.value=d.right.myTeams.filter(p=>p.ownersCount===1&&p.myRole==="OWNER")},y=b(!1),w=async()=>{y.value||(y.value=!0,P(Ot(),me(d=>{y.value=!1,o.error(k(d))},()=>{y.value=!1,a.value=!1,o.success(s("settings.account_deleted")),Ze(),l.push("/")}))())},k=d=>{if(d.type==="network_error")return s("error.network_error");switch(d.error){case"shortcode/not_found":return s("shortcodes.not_found");default:return s("error.something_went_wrong")}};return(d,p)=>{const g=ee,x=te,C=pe,$=We;return i(),h("section",qt,[t("h4",Pt,n(e(s)("settings.delete_account")),1),t("div",Gt,n(e(s)("settings.delete_account_description")),1),c(g,{filled:"",outline:"",label:e(s)("settings.delete_account"),type:"submit",onClick:p[0]||(p[0]=r=>a.value=!0)},null,8,["label"]),a.value?(i(),A($,{key:0,dialog:"",title:e(s)("settings.delete_account"),onClose:p[3]||(p[3]=r=>a.value=!1)},{body:E(()=>[S.value?(i(),h("div",Yt,[c(x,{class:"mb-4"}),t("span",Ft,n(e(s)("state.loading")),1)])):m.value.length?(i(),h("div",Ht,[t("h2",Zt,n(e(s)("error.danger_zone")),1),t("div",null,[M(n(e(s)("error.delete_account"))+" ",1),t("ul",Wt,[(i(!0),h(de,null,ue(m.value,r=>(i(),h("li",{key:r.id},n(r.name),1))),128))]),t("span",Qt,n(e(s)("error.delete_account_description")),1)])])):(i(),h("div",Jt,[t("div",Xt,[t("h2",Kt,n(e(s)("error.danger_zone")),1),t("div",es,n(e(s)("settings.delete_account_description")),1)]),t("div",ts,[T(t("input",{id:"deleteUserAccount","onUpdate:modelValue":p[1]||(p[1]=r=>_.value=r),class:"input floating-input",placeholder:" ",type:"text",autocomplete:"off"},null,512),[[K,_.value]]),ss])]))]),footer:E(()=>[t("span",os,[c(C,{label:e(s)("settings.delete_account"),loading:y.value,filled:"",outline:"",disabled:S.value||m.value.length>0||_.value!=="delete my account",class:"!bg-red-500 !hover:bg-red-600 !border-red-500 !hover:border-red-600",onClick:w},null,8,["label","loading","disabled"]),c(g,{label:e(s)("action.cancel"),outline:"",filled:"",onClick:p[2]||(p[2]=r=>a.value=!1)},null,8,["label"])])]),_:1},8,["title"])):j("",!0)])}}}),ls={preserveAspectRatio:"xMidYMid meet",viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},is=t("g",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2"},[t("path",{d:"M12 3c-1.2 0-2.4.6-3 1.7A3.6 3.6 0 0 0 4.6 9c-1 .6-1.7 1.8-1.7 3s.7 2.4 1.7 3c-.3 1.2 0 2.5 1 3.4c.8.8 2.1 1.2 3.3 1c.6 1 1.8 1.6 3 1.6s2.4-.6 3-1.7c1.2.3 2.5 0 3.4-1c.8-.8 1.2-2 1-3.3c1-.6 1.6-1.8 1.6-3s-.6-2.4-1.7-3c.3-1.2 0-2.5-1-3.4a3.7 3.7 0 0 0-3.3-1c-.6-1-1.8-1.6-3-1.6Z"}),t("path",{d:"m9 12l2 2l4-4"})],-1),rs=[is];function cs(f,s){return i(),h("svg",ls,rs)}const le={name:"lucide-verified",render:cs},as={class:"container"},ds={class:"p-4"},us={key:0,class:"flex flex-col items-center justify-center flex-1 p-4"},_s={key:1,class:"flex flex-col items-center justify-center"},hs=["src","alt"],ms={class:"pb-4 text-center text-secondaryLight"},ps={key:2,class:"space-y-8"},fs=t("div",{class:"h-24 rounded bg-primaryLight -mb-11 md:h-32",style:{"background-image":"url('/images/cover.svg')"}},null,-1),vs={class:"flex flex-col justify-between px-4 space-y-8 md:flex-row"},ys={class:"flex items-end"},gs={class:"ml-4"},bs={class:"heading"},xs={class:"flex items-center text-secondaryLight"},$s={class:"flex items-end space-x-2"},Ss={class:"grid grid-cols-1"},ws={class:"p-4"},ks={class:"font-semibold text-secondaryDark"},Cs={class:"my-1 text-secondaryLight"},Ls={class:"py-4"},Ds={for:"displayName"},Es=["onSubmit"],Ns=["placeholder"],Ms={class:"py-4"},Rs={for:"emailAddress"},Is=["onSubmit"],As=["placeholder"],Us={class:"p-4"},Ts={class:"font-semibold text-secondaryDark"},js={class:"my-1 text-secondaryLight"},Bs={class:"py-4 space-y-4"},Vs={class:"flex items-center"},zs={class:"flex items-center"},Os={class:"flex items-center"},Ws=Y({__name:"profile",setup(f){var R,B;const s=b("sync"),o=F(),l=H(),a=_e();ae({title:U(()=>o("navigation.profile"))});const _=J("syncCollections"),S=J("syncEnvironments"),m=J("syncHistory"),u=I(he,null),y=I(ot,null),w=U(()=>y.value?!u.value:!1),k=b((R=u.value)==null?void 0:R.displayName),d=b(!1);G(()=>{var N;return k.value=(N=u.value)==null?void 0:N.displayName});const p=()=>{d.value=!0,nt(k.value).then(()=>{l.success(`${o("profile.updated")}`)}).catch(()=>{l.error(`${o("error.something_went_wrong")}`)}).finally(()=>{d.value=!1})},g=b((B=u.value)==null?void 0:B.email),x=b(!1);G(()=>{var N;return g.value=(N=u.value)==null?void 0:N.email});const C=()=>{x.value=!0,lt(g.value).then(()=>{l.success(`${o("profile.updated")}`)}).catch(()=>{l.error(`${o("error.something_went_wrong")}`)}).finally(()=>{x.value=!1})},$=b(!1),r=()=>{$.value=!0,Xe().then(()=>{l.success(`${o("profile.email_verification_mail")}`)}).catch(()=>{l.error(`${o("error.something_went_wrong")}`)}).finally(()=>{$.value=!1})};return(N,v)=>{const Z=te,V=pe,z=Ke,fe=le,W=ee,ve=et,ye=tt,ge=ns,Q=ut,be=zt,se=Ce,xe=st,$e=Le,Se=ie("tippy");return i(),h("div",null,[t("div",as,[t("div",ds,[e(w)?(i(),h("div",us,[c(Z,{class:"mb-4"})])):e(u)===null?(i(),h("div",_s,[t("img",{src:`/images/states/${e(a).value}/login.svg`,loading:"lazy",class:"inline-flex flex-col object-contain object-center w-24 h-24 my-4",alt:`${e(o)("empty.parameters")}`},null,8,hs),t("p",ms,n(e(o)("empty.profile")),1),c(V,{label:e(o)("auth.login"),class:"mb-4",onClick:v[0]||(v[0]=D=>e(Qe)("modals.login.toggle"))},null,8,["label"])])):(i(),h("div",ps,[fs,t("div",vs,[t("div",ys,[e(u).photoURL?(i(),A(z,{key:0,url:e(u).photoURL,alt:e(u).displayName||e(o)("profile.default_displayname"),class:"ring-primary ring-4",size:"16",rounded:"lg"},null,8,["url","alt"])):(i(),A(z,{key:1,initial:e(u).displayName||e(u).email,rounded:"lg",size:"16",class:"ring-primary ring-4"},null,8,["initial"])),t("div",gs,[t("label",bs,n(e(u).displayName||e(o)("profile.default_hopp_displayname")),1),t("p",xs,[M(n(e(u).email)+" ",1),e(u).emailVerified?T((i(),A(fe,{key:0,title:e(o)("settings.verified_email"),class:"ml-2 text-green-500 svg-icons focus:outline-none cursor-help"},null,8,["title"])),[[Se,{theme:"tooltip"}]]):(i(),A(W,{key:1,label:e(o)("settings.verify_email"),icon:e(le),class:"px-1 py-0 ml-2",loading:$.value,onClick:r},null,8,["label","icon","loading"]))])])]),t("div",$s,[t("div",null,[c(ve,{to:"/settings",icon:e(Je),label:e(o)("profile.app_settings"),outline:""},null,8,["icon","label"])]),c(ye,{outline:""})])]),c($e,{modelValue:s.value,"onUpdate:modelValue":v[6]||(v[6]=D=>s.value=D),styles:"sticky overflow-x-auto flex-shrink-0 bg-primary top-0 z-10","render-inactive-tabs":""},{default:E(()=>[c(se,{id:"sync",label:e(o)("settings.account")},{default:E(()=>[t("div",Ss,[t("section",ws,[t("h4",ks,n(e(o)("settings.profile")),1),t("div",Cs,n(e(o)("settings.profile_description")),1),t("div",Ls,[t("label",Ds,n(e(o)("settings.profile_name")),1),t("form",{class:"flex mt-2 md:max-w-sm",onSubmit:ne(p,["prevent"])},[T(t("input",{id:"displayName","onUpdate:modelValue":v[1]||(v[1]=D=>k.value=D),class:"input",placeholder:`${e(o)("settings.profile_name")}`,type:"text",autocomplete:"off",required:""},null,8,Ns),[[K,k.value]]),c(W,{filled:"",outline:"",label:e(o)("action.save"),class:"ml-2 min-w-16",type:"submit",loading:d.value},null,8,["label","loading"])],40,Es)]),t("div",Ms,[t("label",Rs,n(e(o)("settings.profile_email")),1),t("form",{class:"flex mt-2 md:max-w-sm",onSubmit:ne(C,["prevent"])},[T(t("input",{id:"emailAddress","onUpdate:modelValue":v[2]||(v[2]=D=>g.value=D),class:"input",placeholder:`${e(o)("settings.profile_name")}`,type:"email",autocomplete:"off",required:""},null,8,As),[[K,g.value]]),c(W,{filled:"",outline:"",label:e(o)("action.save"),class:"ml-2 min-w-16",type:"submit",loading:x.value},null,8,["label","loading"])],40,Is)])]),c(ge),t("section",Us,[t("h4",Ts,n(e(o)("settings.sync")),1),t("div",js,n(e(o)("settings.sync_description")),1),t("div",Bs,[t("div",Vs,[c(Q,{on:e(_),onChange:v[3]||(v[3]=D=>e(X)("syncCollections"))},{default:E(()=>[M(n(e(o)("settings.sync_collections")),1)]),_:1},8,["on"])]),t("div",zs,[c(Q,{on:e(S),onChange:v[4]||(v[4]=D=>e(X)("syncEnvironments"))},{default:E(()=>[M(n(e(o)("settings.sync_environments")),1)]),_:1},8,["on"])]),t("div",Os,[c(Q,{on:e(m),onChange:v[5]||(v[5]=D=>e(X)("syncHistory"))},{default:E(()=>[M(n(e(o)("settings.sync_history")),1)]),_:1},8,["on"])])])]),c(be)])]),_:1},8,["label"]),c(se,{id:"teams",label:e(o)("team.title")},{default:E(()=>[c(xe,{modal:!1,class:"p-4"})]),_:1},8,["label"])]),_:1},8,["modelValue"])]))])])])}}});export{Ws as default};
//# sourceMappingURL=profile.a7f2e625.js.map
